function checkLogin(config){
	config = config || {};
	$('.btn-login').click(function (){
		checkForm(config);
	});
	$('#vcode').click(function (){
		$(this).css('backgroundImage','url('+config.vcode+"&r="+Math.random()+') ');
	});
	$("#account,#password,#vcode").keydown(function(event){
		if(event.keyCode==13){
		   checkForm(config);
		}
	});
}
function checkForm(config){
	config       = config || {};
	var account  = $("#account").val();
	var password = $("#password").val();
	var verify   = $("#vcode").val();

	if (!account) {
		$("#account").focus().css('borderColor','#FC3D4A');
		$('#tips').text('用户名/邮箱不能为空');return false;
	};
	if (!password) {
		$("#password").focus().css('borderColor','#FC3D4A');
		$('#tips').text('密码不能为空');return false;
	};
	if (typeof(verify) != "undefined" && !verify) {
		$("#vcode").focus().css('borderColor','#FC3D4A');
		$('#tips').text('验证码不能为空');return false;
	}
	$.ajax({
		type: "post",
		url: config.posturl,
		dataType:'json',
		data:{account:account, password:password, verify:verify},
		timeout:10000,
		beforeSend: function(){ $('.tips').text('正在验证中...'); },
		success: function(data){
			var info = data.info;
			if (data.status == 0) {
				if(info.errortype == 3 && info.errornum >= 3){
					location.href = location.href;
					return false;
				}else{
					$("#vcode").css('backgroundImage','url('+config.vcode+"&r="+Math.random()+')');
					$("#"+info.formid).focus().css('borderColor','#FC3D4A');
				}
				$('#tips').text(info.msg);
			} else {
				$('#tips').text(info.msg);
				location.href = info.href;
			}
		},
		error: function(){
			$('#tips').text('数据链接失败');return false;
		}
	});

}
if(window.top!=window.self){
	window.top.location.href=window.top.location.href;
	window.top.location.reload();
	//top.window.location.reload;
	//if(self!=top) top.location=self.location;
}
if ( /msie/.test(navigator.userAgent.toLowerCase()) && 8 > $.browser.version) {
	$('.btn-login').attr('disabled',true);
	$('.tips').html('该系统不支持IE6,IE7浏览器<br/>请更换其他高级浏览器');
}
